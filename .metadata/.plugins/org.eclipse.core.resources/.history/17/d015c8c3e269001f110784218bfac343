package controller;

import java.util.Arrays;
import java.util.List;

import jakarta.ws.rs.GET;
import jakarta.ws.rs.Path;
import jakarta.ws.rs.PathParam;
import jakarta.ws.rs.Produces;
import jakarta.ws.rs.client.ClientBuilder;
import jakarta.ws.rs.client.WebTarget;
import jakarta.ws.rs.core.MediaType;
import model.Respuesta;

/*
 * Servicio REST formación

Crear un servicio REST que exponga un recurso que, a partir de un área recibida en la URL,
devuelva una listado de cursos que pertenezcan a dicha área. 
 */
public class ServicioFormacion {

	@GET
	@Path("/buscar")
	@Produces(MediaType.APPLICATION_JSON)
	public List<Respuesta> buscar(@PathParam("tematica") String tematica) {
	
		String url = "http://localhost:8080/04_crud_cursos";
		WebTarget wt=ClientBuilder
				.newClient()
				.target(url);
		
		Respuesta[] datos=wt
				.path("/recuperartodos/")		
				.request(MediaType.APPLICATION_JSON)
				.get(Respuesta[].class);
		List<Respuesta> res = Arrays.asList(datos);
		
		return res.stream()
				.filter(c->c.getTematica().equals(tematica))
				.toList();
	}
}
